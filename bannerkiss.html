
<html>
<head>
    <meta charset="utf-8">
    <title>Bannerkiss Writer</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Chakra+Petch&display=swap" rel="stylesheet">


    <style>

body{
margin: 0;
    }



.Poga{
padding-left: 5px;
padding-right: 5px;
opacity: 0.2;
padding-bottom: 0;
display: block;
color: black;
box-shadow: 0 0 8px #48aa79; 
background: #63f2aa;
}

.Apaksa{
opacity: 0.2;
margin-right: 20px;
font-size: 20px;
}

.Apaksa2{
opacity: 0.9;
margin-right: 20px;
font-size: 20px;
}


#FileName{
}

.Poga:hover{
  opacity: 1;
  padding-bottom: 0;
display: block;
/*width: 340px;*/
/*height: 30px;*/
background: #63f2aa;
color: black;
text-shadow: 0 0 8px black; 
box-shadow: 0 0 8px #48aa79; 
}

.PogaInvert{
padding-left: 5px;
padding-right: 5px;
opacity: 1;
padding-bottom: 0;
display: block;
color: black;
box-shadow: 0 0 8px #48aa79; 
background: #63f2aa;
text-wrap:nowrap;
margin-bottom: 10px;
}

.PogaInvert:hover{
  opacity: 0.2;
  padding-bottom: 0;
display: block;
/*width: 340px;*/
/*height: 30px;*/
background: #63f2aa;
color: black;
text-shadow: 0 0 8px black; 
box-shadow: 0 0 8px #48aa79; 
}

#InfoGraphics{
text-align: right;
width: 220px;

/*background: red;*/
opacity: 0.3;
/*clear: both;*/
padding-bottom: 0;
display: inline-block;

}


#editor {
    width: 100%;

    overflow: auto;
}

.Augstums80{
      height: 80%;
}

.Augstums50{
      height: 50%;
}

.Augstums60{
      height: 72%;
}



[contenteditable] {
  outline: 0px solid transparent;
}

/** width */
::-webkit-scrollbar {
  width: 4px;
  /*box-shadow: 0 0 8px #48aa79; */
  
}

/* Track */
::-webkit-scrollbar-track {
  /*background: #f1f1f1;*/
}

/* Handle */
::-webkit-scrollbar-thumb {
  background: #63f2aa;
  
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
  /*background: #555;*/
}

#wraper {
    width: 100%;
    height: 100%;
    background: rgb(47,51,60);
background: linear-gradient(130deg, rgba(47,51,60,1) 0%, rgba(26,30,33,1) 100%);
    margin: auto;
    display: block;
  align-items: center;

}
#EditorScreen{
  padding: 5%;
}

#ScreenWrapper{
    float: left;
    font-family: 'Chakra Petch', Tahoma, sans-serif;
    background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDkuMC1jMDAwIDc5LmRhNGE3ZTVlZiwgMjAyMi8xMS8yMi0xMzo1MDowNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NDFGMDcwQTBBQTUwMTFFRThCREJBQkZGNzc3NzZCRTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NDFGMDcwOUZBQTUwMTFFRThCREJBQkZGNzc3NzZCRTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjAgKDIwMjMwODE3Lm0uMjI5MCAxNWRmYzIxKSAgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MUIzNTZEMzNBQTNDMTFFRUI2RjdCMEU1MkNFOTQ5NzYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MUIzNTZEMzRBQTNDMTFFRUI2RjdCMEU1MkNFOTQ5NzYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7P4nzHAAAAFUlEQVR42mJg4+KUZfr942cyQIABAAqwA4imtQFCAAAAAElFTkSuQmCC');
    
    /*opacity: 0.5;*/
    width: 100%;
    height: 100%;
    overflow: hidden;

}
.green{
/*text-shadow: 0 0 8px #48aa79; */
color: #63f2aa;
opacity: 0.9;
}

.big{
font-size: 1.3em;
}

.medium{
font-size: 18px;
}

.small{
font-size: 16px;
}
.vissible{
  display: block;

}

.unvissible{
  display: none;
}

#BT1{
    top: -126px;
    position: relative;
    left: 50px;
}
.Button{
  width: 35px;
  height: 35px;
  background: url(Button.png);
}
.opacity5{
  opacity: 0.3;
}
.Stats{
  display: inline-block;
}
.Info{
  height: 10%;
    display: flex;
        align-items: flex-start;
        overflow: auto;
        padding-top: 20px;
}
#menu{
  height: 20%;
  padding-top: 20px;
  overflow: auto;

}
#Menus{
    display: block;
}
.Bloks{
  display: block;
  padding-bottom: 10px;
}
.Flex{
    display: flex;
    align-items: flex-end;
    padding-bottom: 10px;
    flex-direction: row;
    flex-wrap: wrap;
}
#about{
  height: 100%;
  /*padding-top: 20px;*/
  overflow: auto;
}


    </style>
</head>
<body>

    <div id="wraper">


            
            <div id="ScreenWrapper" class="green big">
              

              <div id="EditorScreen" class="vissible">
                
                 <div id="editor" class="Augstums80" contenteditable="true"><br /></div>

                 <div id="Info" class="Info">

                    <div id="Slogan" class="Apaksa" > Bannerkiss Writer</div>
                    <div id="FileName" class="Poga Apaksa" onclick="ShowMenu()" > File </div>
                    <div id="FileName" class="Poga Apaksa" onclick="ShowAbout()" > i </div>
                    <div class="Apaksa">
                        <div id="" class="Stats">CH:</div>
                        <div id="Characters" class="Stats"></div>
                        <div id="" class="Stats">WR:</div>
                        <div id="Words" class="Stats"></div>
                    </div>
                  </div>

                  <div id="menu" class="unvissible">

                      <div class="Bloks">
                        <div class="Apaksa MenuInfo">File operations:</div>
                      </div>
                      <div class="Flex">
                      <div class="PogaInvert Apaksa" onclick="copy()">Copy TXT to clipboard</div>
                      <div class="PogaInvert Apaksa" onclick="Download()">Download TXT File</div>
                      <div class="PogaInvert Apaksa" onclick="OpenFile()">Upload TXT File</div>
                      <div class="PogaInvert Apaksa" onclick="ShowEditor()">Cancel</div>
                      <input id="myFile" type="file" style="display:none;">
                      </div>
                       

                      <div class="Apaksa2">Tip! All your edited text is automaticly saved in your browser local storage. As long you dont clear browser storage, edited text should be safe.</div>
                </div>
                  
                  <div id="about" class="unvissible">

                      <div class="Bloks">
                        <div class="Apaksa2">About Bannerkiss Writer v2.1<br><br>Hey, I am Oto Rudoviƒçs AKA Dendrobats. I really like Vintage Brother Word Processors WP-80, they are really distraction free. But needed something that is more portable. So I made this distraction free writer for anyone who wishes to use it. It autostores all data in your local browsers memory. So you can close your browser and reopen same page and all data will be saved. It dont store anything on server. This script/html dont need internet to work actualy it can work localy, just download latest version and launch it on any modern browser. So you can turn any old laptop in distraction free writer. All you need to do is install chrome or any other modern browser and launch this script. You can also use browsers built in spell check if you wish, or install any other. Tested on Chrome.<br /><br />Change log:<br>- v.2.1 - firefox not working fix.<br>
                                       - v.2.0 - bugfixes and cursor to the end of a content feature.
                                       <br><br> </div>
                      </div>
                      <div class="Flex">
                        <div class="PogaInvert Apaksa" ><a style="text-decoration: none; color: black;" href="https://bannerkiss.com/BKW2/BKW2.zip">Download latest version</a></div>
                      </div>
                      <div class="Flex">
                        <div class="PogaInvert Apaksa" onclick="HideAbout()">Close</div>
                      </div>
                </div>

              </div>
               
                
            </div>


    </div>

</body>
<script>

restoreCACHE();

CracketAtEnd();

    
function CracketAtEnd() {

        const contentEle = document.getElementById('editor');
        const range = document.createRange();
        const selection = window.getSelection();
        range.setStart(contentEle, contentEle.childNodes.length);
        range.collapse(true);
        selection.removeAllRanges();
        selection.addRange(range);

};




function restoreCACHE() {
    var editorKey = 'BKW2';
    var editor = document.getElementById('editor');
    var cache = localStorage.getItem(editorKey);

    if (cache) {
        editor.innerHTML  = cache;
    }

    function autosave() {
        var newValue = editor.innerHTML ;
        if (cache != newValue) {
            cache = newValue;
            localStorage.setItem(editorKey, cache);
        }
    }

    editor.addEventListener('input', autosave);
};


function SaveCACHE() {

    var editorKey = 'BKW2';
    var editor = document.getElementById('editor');
    var cache = editor.innerHTML;
    localStorage.setItem(editorKey, cache);
};


  function copy() {

     ShowEditor();

      var target = document.getElementById('editor');
      var range, select;
      if (document.createRange) {
        range = document.createRange();
        range.selectNodeContents(target)
        select = window.getSelection();
        select.removeAllRanges();
        select.addRange(range);
        document.execCommand('copy');
        select.removeAllRanges();
      } else {
        range = document.body.createTextRange();
        range.moveToElementText(target);
        range.select();
        document.execCommand('copy');
      }
    }

  function ShowMenu(){
    document.getElementById("Info").classList.add('unvissible');
    document.getElementById("Info").classList.remove('Info');

    document.getElementById("menu").classList.add('vissible');
    document.getElementById("menu").classList.remove('unvissible');

    document.getElementById("editor").classList.add('Augstums60');
    document.getElementById("editor").classList.remove('Augstums80');
  }

  function ShowEditor(){
    document.getElementById("Info").classList.add('Info');
    document.getElementById("Info").classList.remove('unvissible');

    document.getElementById("menu").classList.add('unvissible');
    document.getElementById("menu").classList.remove('vissible');

    document.getElementById("editor").classList.add('Augstums80');
    document.getElementById("editor").classList.remove('Augstums60');

    CracketAtEnd();
  }

function ShowAbout(){
    document.getElementById("Info").classList.add('unvissible');
    document.getElementById("Info").classList.remove('Info');

    document.getElementById("about").classList.add('vissible');
    document.getElementById("about").classList.remove('unvissible');

    document.getElementById("editor").classList.add('unvissible');
    document.getElementById("editor").classList.remove('Augstums80');
  }

function HideAbout(){
    document.getElementById("Info").classList.add('Info');
    document.getElementById("Info").classList.remove('unvissible');

    document.getElementById("about").classList.add('unvissible');
    document.getElementById("about").classList.remove('vissible');

    document.getElementById("editor").classList.add('Augstums80');
    document.getElementById("editor").classList.remove('unvissible');
    CracketAtEnd();
  }





function Download(){

  ShowEditor();

function downloadInnerHtml(filename, elId, mimeType) {
    
    var elHtml = document.getElementById('editor').innerText;
    // var Reformat = elHtml.replace(/<br\s*[\/]?>/gi, "\n");
       
    var link = document.createElement('a');
    mimeType = mimeType || 'text/plain';

    link.setAttribute('download', filename);
    link.setAttribute('href', 'data:' + mimeType + ';charset=utf-8,' + elHtml);
    link.click(); 
}

var fileName =  'Backup_'+Date().toString()+'.txt';
downloadInnerHtml(fileName, 'editor','text/html');
}


function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}



function OpenFile() {
Download();
sleep(1000).then(() => { document.getElementById("myFile").click(); });
}

var input = document.getElementById("myFile");
var output = document.getElementById("editor");

input.addEventListener("change", function () {
  if (this.files && this.files[0]) {
    var myFile = this.files[0];
    var reader = new FileReader();
    
    reader.addEventListener('load', function (e) {
      output.textContent = e.target.result;
    });
    
    //reader.readAsBinaryString(myFile);
    reader.readAsText(myFile);

  }

  ShowEditor();
  sleep(1000).then(() => { SaveCACHE(); });
});


var editor = document.getElementById("editor");
var Characters = document.getElementById("Characters");
var Words = document.getElementById("Words");

editor.addEventListener('input', CountCharacters);

function CountCharacters(){
  //console.log(editor.innerHTML.length);
  Characters.innerText = editor.innerHTML.length;
  Words.innerText = editor.innerHTML.split(/\W+/).length;
}

CountCharacters();

    


</script>
</html>

